<!--

  This is an experiment in auto-styling dataset visualizations based on auto-detected datatypes.

  Example dataset:
  http://192.168.1.108:8080/auto-styling.html?dataset=8581a7460e144ae09ad25d47f8e82af8_0


-->

<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta
  name="viewport"
  content="initial-scale=1,maximum-scale=1,user-scalable=no"
  />
  <title>Tab Navigation Demo</title>
  <link href="tabnav-min.css" rel="stylesheet">

  <!-- <script src="https://unpkg.com/lodash@4.17.15/lodash.js"></script> -->
  <!-- <script src="lodash.js"></script> -->
	<script src='https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.68/Tone.js'></script>

  <!-- <link rel="stylesheet" href="https://s3-us-west-1.amazonaws.com/patterns.esri.com/files/calcite-web/1.2.5/css/calcite-web.min.css"> -->
  <!-- <script src="https://s3-us-west-1.amazonaws.com/patterns.esri.com/files/calcite-web/1.2.5/js/calcite-web.min.js"></script> -->

  <!-- calcite components -->
  <script
  type="module"
  src="https://unpkg.com/@esri/calcite-components@1.0.0-beta.33/dist/calcite/calcite.esm.js"
></script>
<script
  nomodule=""
  src="https://unpkg.com/@esri/calcite-components@1.0.0-beta.33/dist/calcite/calcite.js"
></script>
<link
  rel="stylesheet"
  type="text/css"
  href="https://unpkg.com/@esri/calcite-components@1.0.0-beta.33/dist/calcite/calcite.css"
/>

  <!-- 3rd party libraries -->
  <script src="https://d3js.org/d3.v4.js"></script>
  <!-- <script src="https://cdn.rawgit.com/fabid/d3-rectbin/master/rectbin.js"></script> -->
  <script src="rectbin.js"></script> <!-- local for debugging -->
  <script src="https://cdn.jsdelivr.net/npm/jstat@latest/dist/jstat.min.js"></script>
  <script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js"></script>

  <script type="module" src="sonar.mjs"></script>
</head>

<body>
  <!-- <div id="sidebar" tabindex="1">
    <div id="sidebarItems">

      <select id="datasetList"></select>
      <div id="datasetName" ></div>
      <div>
        <span id="orgName"></span>
        <span id="recordCount"></span>
      </div>

      <div class="section">
        <span class="sectionHead">Filters:</span>
        <span id="filtersCount"></span>

        <div id="filtersList">
        </div>
        <span id="label">Filter <span id="featuresCount"></span> features:</span>
        <calcite-input type="search" scale="s" id="filterAttributeSearch" placeholder="Search Attributes by Name" aria-label="Search attributes"></calcite-input>

        <div id="filterAttributeList">
        </div>
      </div>

      <div class="section">
        <span id="label">Style by Attribute:</span>
        <calcite-input type="search" scale="s" id="styleAttributeSearch" placeholder="Search Attributes by Name" aria-label="Search stories"></calcite-input>
        <div id="styleAttributeList">
        </div>
      </div>

    </div>
  </div> -->
  <div id="viewDiv" tabindex="0" aria-label="Map"></div>
  <!-- <div id="zoomToData" class="esri-widget">
    <label>
      <calcite-checkbox checked="true"></calcite-checkbox>Zoom to data
    </label>
  </div> -->
  <!-- <div id="darkMode" class="esri-widget">
    <label>
      <calcite-checkbox checked="false"></calcite-checkbox>Dark mode
    </label>
  </div>
  <div id="labels" class="esri-widget">
    <label>
      <calcite-checkbox checked="false"></calcite-checkbox>Force labels
    </label>
  </div> -->

  <div id="keyboardModeMenu" tabindex="0">

    <input type="checkbox" tabindex="0" id="featureSelectionModeButton" aria-labelledby="featureSelectionModeLabel"></input>
    <label id="featureSelectionModeLabel">Feature selection</label>
    <input type="checkbox" tabindex="0" id="featureModeButton" aria-labelledby="featureModeLabel"></input>
    <label id="featureModeLabel">Inspect Feature</label>
    <input type="checkbox" tabindex="0" id="verboseCheckbox" aria-labelledby="verboseLabel"></input>
    <label id="verboseLabel">Verbose</label>
    <input type="checkbox" tabindex="0" id="sonarModeCheckbox" aria-labelledby="sonarModeLabel"></input>
    <label id="sonarModeLabel">Sonar</label>
    <input type="checkbox" tabindex="0" id="helpButton" aria-labelledby="helpButtonLabel"></input>
    <label id="helpButtonLabel">Help</label>

  </div>


  <div id="status">
    <div>
      Focus:
      <span id="focusStatus">focusStatus</span>
    </div>
    <div>
      Key:
      <span id="keyStatus">keyStatus</span>
    </div>
    <div>
      Mode:
      <span id="modeStatus">modeStatus</span>
    </div>
  </div>
  <div id="alertDivWrapper">
    Speech announcement
    <div id="alertDiv" role="alert">
      Top level.
    </div>
  </div>
  <div id="helpDivWrapper">
    <b>Esri Sonar Map</b>
    <div id="helpDiv" role="alert">
      <p>This is a map of the world which uses non-visual navigation. It shows 2000 global features from a water quality database.</p>

      <p>The arrow keys will move the map. The "z" and "x" keys will zoom in and out. Zoom 0 shows the whole world, zoom 6 is roughly the size of a country, zoom 12 is city level, and zoom 16 shows individual streets. The "c" key will center and zoom in on a selected feature.</p>

      <p>The number keys also set zoom levels 0 through 9.</p>

      <p>There is a menu with five checkboxes. Pressing enter on each will toggle the selected mode.</p>

      <p>1) Feature selection. Press Tab and Shift-tab to move forward and back through onscreen features. Press escape to exit selection mode and return to the menu. Press Enter to examine a selected feature's data.</p>

      <p>2) Inspect feature. Press Tab and Shift-tab to move forward and back through a selected feature's attributes. Press escape to leave the feature and return to selection mode.</p>

      <p>3) Verbose. This mode will announce zoom levels and a geolocation result for the part of the map in the center of the screen.</p>

      <p>4) Sonar. This mode converts the onscreen features to a musical score from left to right, with relative vertical screen position converted to pitch. A sonar ping will play when the map is moved. The "s" key will also send a ping. When this mode is activated, individual features will be played in Feature selection mode.</p>

      <p>5) Help. This button shows this help text. Press escape to close it.</p>
    </div>
  </div>

  <!-- popup content template -->
  <div style="position: absolute; visibility: hidden" id="popup-content-template">
    <h3 id="placeLabel" tabindex="0"></h3> <!-- needs a tabindex so it can be .focus()ed -->
    <table id="popupTable" aria-label='Feature Attributes'>
      <thead>
        <tr>
          <th role='columnheader'>Attribute Name</th>
          <th role='columnheader'>Attribute Value</th>
        </tr>
      </thead>

    </table>
  </div>

</body>
</html>
